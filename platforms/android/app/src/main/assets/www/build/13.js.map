{"version":3,"sources":["../../src/pages/invite-user/invite-user.module.ts","../../src/pages/invite-user/invite-user.ts"],"names":[],"mappings":"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","file":"13.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { InviteUserPage } from './invite-user';\n\n@NgModule({\n  declarations: [\n    InviteUserPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(InviteUserPage),\n  ],\n})\nexport class InviteUserPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/invite-user/invite-user.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ToastController } from 'ionic-angular';\nimport { User } from '../../models/user';\nimport { Event } from '../../models/event';\nimport * as firebase from 'firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-invite-user',\n  templateUrl: 'invite-user.html',\n})\nexport class InviteUserPage {\n\n  eventId = \"\" as string;\n  user = {} as User;\n  email = \"\";\n  msg = \"\";\n\n  constructor(public navCtrl: NavController,\n              public navParams: NavParams,\n              public toastCtrl: ToastController) {\n    this.eventId = navParams.data.toString();\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad InviteUserPage');\n  }\n\n  invite(){\n    var ucRef = firebase.firestore().collection('Users').where(\"email\", \"==\", this.email).get().then((d)=>{\n      if (d.docs.length > 0){\n        console.log(\"has !\");\n        this.pushInviteRequest(d.docs[0].id);\n      }\n    });\n  }\n\n  async pushInviteRequest(fId){\n    try{\n    let uRef = firebase.firestore().collection('Users').doc(fId);\n    let eRef = firebase.firestore().collection('Event').doc(this.eventId);\n    // determine if the person is already in list\n    eRef.get().then(doc =>{\n      var canFind = doc.data().participants.find((ele)=>{return ele.isEqual(uRef);});\n      if (undefined != canFind){\n        this.toastCtrl.create({\n          message: \"User already in the event\",\n          duration: 3000,\n          position: \"bottom\"\n        }).present();\n      }\n      else{\n        let fReq = firebase.firestore().collection('Request').doc(fId);\n        fReq.get().then(doc=>{\n          var is = doc.data().eventRequest.find((fr)=> { return fr.from.isEqual(eRef); });\n          if (undefined == is){\n            let fReqList = doc.data().eventRequest;\n            fReqList.push({\n              from: eRef,\n              msg: this.msg.trim()\n            });\n            fReq.update('eventRequest',fReqList);\n            this.toastCtrl.create({\n              message: \"Sent \" + this.email + \" a invite request\",  // Even its blocked, show cannot find to prevent user\n              duration: 3000,\n              position: \"bottom\"\n            }).present();\n          }\n        });\n      }\n    });\n    }\n    catch(e){\n      console.log(e);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/invite-user/invite-user.ts"],"sourceRoot":""}