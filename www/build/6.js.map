{"version":3,"sources":["../../src/pages/qr-scan/qr-scan.module.ts","../../src/pages/join-event/join-event.module.ts","../../src/pages/qr-scan/qr-scan.ts","../../src/pages/join-event/join-event.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { QrScanPage } from './qr-scan';\n//import { BarcodeScanner } from '@ionic-native/barcode-scanner';\n\n@NgModule({\n  declarations: [\n    QrScanPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(QrScanPage),\n    //BarcodeScanner\n  ],\n})\nexport class QrScanPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/qr-scan/qr-scan.module.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { QrScanPageModule} from '../qr-scan/qr-scan.module';\nimport { JoinEventPage } from './join-event';\n\n@NgModule({\n  declarations: [\n    JoinEventPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(JoinEventPage),\n    QrScanPageModule,\n  ],\n})\nexport class JoinEventPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/join-event/join-event.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner';\n\n@IonicPage()\n@Component({\n  selector: 'page-qr-scan',\n  templateUrl: 'qr-scan.html',\n})\nexport class QrScanPage {\n  code = \"\";\n  callback: any;\n\n  constructor(public navCtrl: NavController,\n              public navParams: NavParams,\n              private barcodeScanner: BarcodeScanner) {\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad QrScanPage');\n  }\n\n  scanCode() {\n    this.barcodeScanner.scan().then(barcodeData => {\n      this.code = barcodeData.text;\n      this.navCtrl.pop();\n    }, (err) => {\n      console.log(\"Cannot Read QR Code!\");\n    });\n  }\n\n  ionViewWillEnter(){\n    this.callback = this.navParams.get(\"callback\");\n  }\n\n  ionViewDidEnter(){\n    this.scanCode();\n  }\n\n  ionViewWillLeave() {\n    this.callback(this.code);\n}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/qr-scan/qr-scan.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ToastController } from 'ionic-angular';\nimport * as firebase from 'firebase';\nimport { User } from '../../models/user';\nimport { Event } from '../../models/event';\n\n@IonicPage()\n@Component({\n  selector: 'page-join-event',\n  templateUrl: 'join-event.html',\n})\nexport class JoinEventPage {\n\n  user = {} as User;\n  event = {} as Event;\n  targetId = \"\";\n  hasPasswd = false as boolean;\n  needScan = true as boolean;\n  eventPwd: string;\n\n  constructor(public navCtrl: NavController,\n              public navParams: NavParams,\n              private toastCtrl: ToastController) {\n    this.user.uid = firebase.auth().currentUser.uid;\n  }\n\n  scanQR(){\n    var cbFunction = (params) =>{\n      return new Promise((resolve,reject)=>{\n        this.targetId = params;\n        this.needScan = false;\n        resolve();\n      })\n    }\n    this.navCtrl.push('QrScanPage',{callback: cbFunction});\n  }\n\n  joinBtn(){\n    if (this.verifyPwd())\n      this.joinEvent(this.targetId);\n    else\n      this.toastCtrl.create({\n        message: \"Incorrect Password\",\n        duration: 3000,\n        position: \"bottom\"\n      }).present();\n  }\n\n  verifyPwd(){\n    if (this.hasPasswd){\n      // verify password\n      return false;\n    }\n    return true;\n  }\n\n  joinEvent(eventId){\n    var userRef = firebase.firestore().collection('Users').doc(this.user.uid);\n    var eventRef = firebase.firestore().collection('Event').doc(eventId);\n    eventRef.get().then( data =>{\n      let isBlocked = data.data().blockedUsers.find(bu =>{ return bu.isEqual(userRef); });\n      if (undefined == isBlocked){\n        var userDoc = userRef.get().then((data)=>{\n          this.user.eventList = data.data().eventList;\n          this.user.eventList.push(eventRef);\n          userRef.update('eventList',this.user.eventList);\n        });\n        var eventDoc = eventRef.get().then((da)=>{\n          this.event.participants = da.data().participants;\n          this.event.participants.push(userRef);\n          eventRef.update('participants',this.event.participants);\n        });\n      }\n      else {\n        this.toastCtrl.create({\n          message: \"Cannot join this event\",\n          duration: 3000,\n          position: \"bottom\"\n        }).present();\n      }\n    });\n  }\n\n  ionViewDidLoad() {\n    this.targetId = this.navParams.get('fromQR');\n    if (undefined == this.targetId) this.targetId = \"\";\n    else this.needScan = false;\n    console.log(this.targetId);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/join-event/join-event.ts"],"sourceRoot":""}